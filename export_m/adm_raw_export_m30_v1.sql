
drop table IF EXISTS export.adm_raw_export_m30_v1;

SELECT
      t1.currency as currency_m30,
      t1.pricedate as pricedate_m30,
      datepart(WEEKDAY,t1.pricedate) as pricedateweekday_m30,
      datepart(HOUR,t1.pricetime) as pricetimehour_m30,
      datepart(MINUTE,t1.pricetime) as pricetimeminute_m30,

      t1.closebid as closebid_m30,
      t1.trend as trend_m30,

  --30分钟特征值
      t1.gapbid_pre_m30_1,
      t1.gapbid_pre_m30_2,
      t1.gapbid_pre_m30_3,
      t1.gapbid_pre_m30_4,
      t1.gapbid_pre_m30_5,
      t1.gapbid_pre_m30_6,
      t1.gapbid_pre_m30_7,
      t1.gapbid_pre_m30_8,
      t1.gapbid_pre_m30_9,
      t1.gapbid_pre_m30_10,
      t1.gapbid_pre_m30_11,
      t1.gapbid_pre_m30_12,

      t1.trend_pre_m30_1,
      t1.trend_pre_m30_2,
      t1.trend_pre_m30_3,
      t1.trend_pre_m30_4,
      t1.trend_pre_m30_5,
      t1.trend_pre_m30_6,
      t1.trend_pre_m30_7,
      t1.trend_pre_m30_8,
      t1.trend_pre_m30_9,
      t1.trend_pre_m30_10,
      t1.trend_pre_m30_11,
      t1.trend_pre_m30_12,

      t1.trend_gap_pre_m30_1,
      t1.trend_gap_pre_m30_2,
      t1.trend_gap_pre_m30_3,
      t1.trend_gap_pre_m30_4,
      t1.trend_gap_pre_m30_5,
      t1.trend_gap_pre_m30_6,
      t1.trend_gap_pre_m30_7,
      t1.trend_gap_pre_m30_8,
      t1.trend_gap_pre_m30_9,
      t1.trend_gap_pre_m30_10,
      t1.trend_gap_pre_m30_11,
      t1.trend_gap_pre_m30_12,

      t2.openclose_m30_1,
      t2.openclose_m30_2,
      t2.openclose_m30_3,
      t2.openclose_m30_4,
      t2.openclose_m30_5,
      t2.openclose_m30_6,
      t2.openclose_m30_7,
      t2.openclose_m30_8,
      t2.openclose_m30_9,
      t2.openclose_m30_10,
      t2.openclose_m30_11,
      t2.openclose_m30_12,

      t2.highlow_m30_1,
      t2.highlow_m30_2,
      t2.highlow_m30_3,
      t2.highlow_m30_4,
      t2.highlow_m30_5,
      t2.highlow_m30_6,
      t2.highlow_m30_7,
      t2.highlow_m30_8,
      t2.highlow_m30_9,
      t2.highlow_m30_10,
      t2.highlow_m30_11,
      t2.highlow_m30_12,

      t2.upbar_m30_1,
      t2.upbar_m30_2,
      t2.upbar_m30_3,
      t2.upbar_m30_4,
      t2.upbar_m30_5,
      t2.upbar_m30_6,
      t2.upbar_m30_7,
      t2.upbar_m30_8,
      t2.upbar_m30_9,
      t2.upbar_m30_10,
      t2.upbar_m30_11,
      t2.upbar_m30_12,

      t2.downbar_m30_1,
      t2.downbar_m30_2,
      t2.downbar_m30_3,
      t2.downbar_m30_4,
      t2.downbar_m30_5,
      t2.downbar_m30_6,
      t2.downbar_m30_7,
      t2.downbar_m30_8,
      t2.downbar_m30_9,
      t2.downbar_m30_10,
      t2.downbar_m30_11,
      t2.downbar_m30_12,



  --小时特征值
      t4.gapbid_pre_m30_h1,
      t4.gapbid_pre_m30_h2,
      t4.gapbid_pre_m30_h3,
      t4.gapbid_pre_m30_h4,
      t4.gapbid_pre_m30_h5,
      t4.gapbid_pre_m30_h6,
      t4.gapbid_pre_m30_h7,
      t4.gapbid_pre_m30_h8,
      t4.gapbid_pre_m30_h9,
      t4.gapbid_pre_m30_h10,
      t4.gapbid_pre_m30_h11,
      t4.gapbid_pre_m30_h12,
      t4.gapbid_pre_m30_h13,
      t4.gapbid_pre_m30_h14,

      t4.trend_pre_m30_h1,
      t4.trend_pre_m30_h2,
      t4.trend_pre_m30_h3,
      t4.trend_pre_m30_h4,
      t4.trend_pre_m30_h5,
      t4.trend_pre_m30_h6,
      t4.trend_pre_m30_h7,
      t4.trend_pre_m30_h8,
      t4.trend_pre_m30_h9,
      t4.trend_pre_m30_h10,
      t4.trend_pre_m30_h11,
      t4.trend_pre_m30_h12,
      t4.trend_pre_m30_h13,
      t4.trend_pre_m30_h14,

      t4.trend_gap_pre_m30_h1,
      t4.trend_gap_pre_m30_h2,
      t4.trend_gap_pre_m30_h3,
      t4.trend_gap_pre_m30_h4,
      t4.trend_gap_pre_m30_h5,
      t4.trend_gap_pre_m30_h6,
      t4.trend_gap_pre_m30_h7,
      t4.trend_gap_pre_m30_h8,
      t4.trend_gap_pre_m30_h9,
      t4.trend_gap_pre_m30_h10,
      t4.trend_gap_pre_m30_h11,
      t4.trend_gap_pre_m30_h12,
      t4.trend_gap_pre_m30_h13,
      t4.trend_gap_pre_m30_h14,

      t5.openclose_m30_h1,
      t5.openclose_m30_h2,
      t5.openclose_m30_h3,
      t5.openclose_m30_h4,
      t5.openclose_m30_h5,
      t5.openclose_m30_h6,
      t5.openclose_m30_h7,
      t5.openclose_m30_h8,
      t5.openclose_m30_h9,
      t5.openclose_m30_h10,
      t5.openclose_m30_h11,
      t5.openclose_m30_h12,
      t5.openclose_m30_h13,
      t5.openclose_m30_h14,

      t5.highlow_m30_h1,
      t5.highlow_m30_h2,
      t5.highlow_m30_h3,
      t5.highlow_m30_h4,
      t5.highlow_m30_h5,
      t5.highlow_m30_h6,
      t5.highlow_m30_h7,
      t5.highlow_m30_h8,
      t5.highlow_m30_h9,
      t5.highlow_m30_h10,
      t5.highlow_m30_h11,
      t5.highlow_m30_h12,
      t5.highlow_m30_h13,
      t5.highlow_m30_h14,

      t5.upbar_m30_h1,
      t5.upbar_m30_h2,
      t5.upbar_m30_h3,
      t5.upbar_m30_h4,
      t5.upbar_m30_h5,
      t5.upbar_m30_h6,
      t5.upbar_m30_h7,
      t5.upbar_m30_h8,
      t5.upbar_m30_h9,
      t5.upbar_m30_h10,
      t5.upbar_m30_h11,
      t5.upbar_m30_h12,
      t5.upbar_m30_h13,
      t5.upbar_m30_h14,

      t5.downbar_m30_h1,
      t5.downbar_m30_h2,
      t5.downbar_m30_h3,
      t5.downbar_m30_h4,
      t5.downbar_m30_h5,
      t5.downbar_m30_h6,
      t5.downbar_m30_h7,
      t5.downbar_m30_h8,
      t5.downbar_m30_h9,
      t5.downbar_m30_h10,
      t5.downbar_m30_h11,
      t5.downbar_m30_h12,
      t5.downbar_m30_h13,
      t5.downbar_m30_h14,


  --结果标签
      r.trend_m30_1,
      r.trend_m30_2,
      r.trend_m30_3,
      r.trend_m30_4,
      r.trend_m30_5,
      r.trend_m30_6,
      r.trend_gap_m30_1,
      r.trend_gap_m30_2,
      r.trend_gap_m30_3,
      r.trend_gap_m30_4,
      r.trend_gap_m30_5,
      r.trend_gap_m30_6

into export.adm_raw_export_m30_v1

FROM adm.m30_price_gap as t1
      LEFT OUTER JOIN adm.m30_price_bar as t2
            on t1.currency=t2.currency and t1.pricedate=t2.pricedate and t1.pricetime=t2.pricetime

      LEFT OUTER JOIN adm.m30_price_gap_h1 as t4
            on t1.currency=t4.currency and t1.pricedate=t4.pricedate and t1.pricetime=t4.pricetime
      LEFT OUTER JOIN adm.m30_price_bar_h1 as t5
            on t1.currency=t5.currency and t1.pricedate=t5.pricedate and t1.pricetime=t5.pricetime
      LEFT OUTER JOIN adm.m30_lable r
            on t1.currency=r.currency and t1.pricedate=r.pricedate and t1.pricetime=r.pricetime
where
  datepart(WEEKDAY,t1.pricedate)!=6 and
  t1.currency='EURUSD'
;