
drop table IF EXISTS export.adm_raw_export_m5_v1;

SELECT
      t1.currency as currency_m5,
      t1.pricedate as pricedate_m5,
      datepart(WEEKDAY,t1.pricedate) as pricedateweekday_m5,
      datepart(HOUR,t1.pricetime) as pricetimehour_m5,
      datepart(MINUTE,t1.pricetime) as pricetimeminute_m5,

      t1.closebid as closebid_m5,
      t1.trend as trend_m5,

  --30分钟特征值
      t1.gapbid_pre_m5_1,
      t1.gapbid_pre_m5_2,
      t1.gapbid_pre_m5_3,
      t1.gapbid_pre_m5_4,
      t1.gapbid_pre_m5_5,
      t1.gapbid_pre_m5_6,
      t1.gapbid_pre_m5_7,
      t1.gapbid_pre_m5_8,
      t1.gapbid_pre_m5_9,
      t1.gapbid_pre_m5_10,
      t1.gapbid_pre_m5_11,
      t1.gapbid_pre_m5_12,

      t1.trend_pre_m5_1,
      t1.trend_pre_m5_2,
      t1.trend_pre_m5_3,
      t1.trend_pre_m5_4,
      t1.trend_pre_m5_5,
      t1.trend_pre_m5_6,
      t1.trend_pre_m5_7,
      t1.trend_pre_m5_8,
      t1.trend_pre_m5_9,
      t1.trend_pre_m5_10,
      t1.trend_pre_m5_11,
      t1.trend_pre_m5_12,

      t1.trend_gap_pre_m5_1,
      t1.trend_gap_pre_m5_2,
      t1.trend_gap_pre_m5_3,
      t1.trend_gap_pre_m5_4,
      t1.trend_gap_pre_m5_5,
      t1.trend_gap_pre_m5_6,
      t1.trend_gap_pre_m5_7,
      t1.trend_gap_pre_m5_8,
      t1.trend_gap_pre_m5_9,
      t1.trend_gap_pre_m5_10,
      t1.trend_gap_pre_m5_11,
      t1.trend_gap_pre_m5_12,

      t2.openclose_m5_1,
      t2.openclose_m5_2,
      t2.openclose_m5_3,
      t2.openclose_m5_4,
      t2.openclose_m5_5,
      t2.openclose_m5_6,
      t2.openclose_m5_7,
      t2.openclose_m5_8,
      t2.openclose_m5_9,
      t2.openclose_m5_10,
      t2.openclose_m5_11,
      t2.openclose_m5_12,

      t2.highlow_m5_1,
      t2.highlow_m5_2,
      t2.highlow_m5_3,
      t2.highlow_m5_4,
      t2.highlow_m5_5,
      t2.highlow_m5_6,
      t2.highlow_m5_7,
      t2.highlow_m5_8,
      t2.highlow_m5_9,
      t2.highlow_m5_10,
      t2.highlow_m5_11,
      t2.highlow_m5_12,

      t2.upbar_m5_1,
      t2.upbar_m5_2,
      t2.upbar_m5_3,
      t2.upbar_m5_4,
      t2.upbar_m5_5,
      t2.upbar_m5_6,
      t2.upbar_m5_7,
      t2.upbar_m5_8,
      t2.upbar_m5_9,
      t2.upbar_m5_10,
      t2.upbar_m5_11,
      t2.upbar_m5_12,

      t2.downbar_m5_1,
      t2.downbar_m5_2,
      t2.downbar_m5_3,
      t2.downbar_m5_4,
      t2.downbar_m5_5,
      t2.downbar_m5_6,
      t2.downbar_m5_7,
      t2.downbar_m5_8,
      t2.downbar_m5_9,
      t2.downbar_m5_10,
      t2.downbar_m5_11,
      t2.downbar_m5_12,



  --小时特征值
      t4.gapbid_pre_m5_h1,
      t4.gapbid_pre_m5_h2,
      t4.gapbid_pre_m5_h3,
      t4.gapbid_pre_m5_h4,
      t4.gapbid_pre_m5_h5,
      t4.gapbid_pre_m5_h6,
      t4.gapbid_pre_m5_h7,
      t4.gapbid_pre_m5_h8,
      t4.gapbid_pre_m5_h9,
      t4.gapbid_pre_m5_h10,
      t4.gapbid_pre_m5_h11,
      t4.gapbid_pre_m5_h12,
      t4.gapbid_pre_m5_h13,
      t4.gapbid_pre_m5_h14,

      t4.trend_pre_m5_h1,
      t4.trend_pre_m5_h2,
      t4.trend_pre_m5_h3,
      t4.trend_pre_m5_h4,
      t4.trend_pre_m5_h5,
      t4.trend_pre_m5_h6,
      t4.trend_pre_m5_h7,
      t4.trend_pre_m5_h8,
      t4.trend_pre_m5_h9,
      t4.trend_pre_m5_h10,
      t4.trend_pre_m5_h11,
      t4.trend_pre_m5_h12,
      t4.trend_pre_m5_h13,
      t4.trend_pre_m5_h14,

      t4.trend_gap_pre_m5_h1,
      t4.trend_gap_pre_m5_h2,
      t4.trend_gap_pre_m5_h3,
      t4.trend_gap_pre_m5_h4,
      t4.trend_gap_pre_m5_h5,
      t4.trend_gap_pre_m5_h6,
      t4.trend_gap_pre_m5_h7,
      t4.trend_gap_pre_m5_h8,
      t4.trend_gap_pre_m5_h9,
      t4.trend_gap_pre_m5_h10,
      t4.trend_gap_pre_m5_h11,
      t4.trend_gap_pre_m5_h12,
      t4.trend_gap_pre_m5_h13,
      t4.trend_gap_pre_m5_h14,

      t5.openclose_m5_h1,
      t5.openclose_m5_h2,
      t5.openclose_m5_h3,
      t5.openclose_m5_h4,
      t5.openclose_m5_h5,
      t5.openclose_m5_h6,
      t5.openclose_m5_h7,
      t5.openclose_m5_h8,
      t5.openclose_m5_h9,
      t5.openclose_m5_h10,
      t5.openclose_m5_h11,
      t5.openclose_m5_h12,
      t5.openclose_m5_h13,
      t5.openclose_m5_h14,

      t5.highlow_m5_h1,
      t5.highlow_m5_h2,
      t5.highlow_m5_h3,
      t5.highlow_m5_h4,
      t5.highlow_m5_h5,
      t5.highlow_m5_h6,
      t5.highlow_m5_h7,
      t5.highlow_m5_h8,
      t5.highlow_m5_h9,
      t5.highlow_m5_h10,
      t5.highlow_m5_h11,
      t5.highlow_m5_h12,
      t5.highlow_m5_h13,
      t5.highlow_m5_h14,

      t5.upbar_m5_h1,
      t5.upbar_m5_h2,
      t5.upbar_m5_h3,
      t5.upbar_m5_h4,
      t5.upbar_m5_h5,
      t5.upbar_m5_h6,
      t5.upbar_m5_h7,
      t5.upbar_m5_h8,
      t5.upbar_m5_h9,
      t5.upbar_m5_h10,
      t5.upbar_m5_h11,
      t5.upbar_m5_h12,
      t5.upbar_m5_h13,
      t5.upbar_m5_h14,

      t5.downbar_m5_h1,
      t5.downbar_m5_h2,
      t5.downbar_m5_h3,
      t5.downbar_m5_h4,
      t5.downbar_m5_h5,
      t5.downbar_m5_h6,
      t5.downbar_m5_h7,
      t5.downbar_m5_h8,
      t5.downbar_m5_h9,
      t5.downbar_m5_h10,
      t5.downbar_m5_h11,
      t5.downbar_m5_h12,
      t5.downbar_m5_h13,
      t5.downbar_m5_h14,


  --结果标签
      r.trend_m5_1,
      r.trend_m5_2,
      r.trend_m5_3,
      r.trend_m5_4,
      r.trend_m5_5,
      r.trend_m5_6,
      r.trend_gap_m5_1,
      r.trend_gap_m5_2,
      r.trend_gap_m5_3,
      r.trend_gap_m5_4,
      r.trend_gap_m5_5,
      r.trend_gap_m5_6

into export.adm_raw_export_m5_v1

FROM adm.m5_price_gap as t1
      LEFT OUTER JOIN adm.m5_price_bar as t2
            on t1.currency=t2.currency and t1.pricedate=t2.pricedate and t1.pricetime=t2.pricetime

      LEFT OUTER JOIN adm.m5_price_gap_h1 as t4
            on t1.currency=t4.currency and t1.pricedate=t4.pricedate and t1.pricetime=t4.pricetime
      LEFT OUTER JOIN adm.m5_price_bar_h1 as t5
            on t1.currency=t5.currency and t1.pricedate=t5.pricedate and t1.pricetime=t5.pricetime
      LEFT OUTER JOIN adm.m5_lable r
            on t1.currency=r.currency and t1.pricedate=r.pricedate and t1.pricetime=r.pricetime
where
  datepart(WEEKDAY,t1.pricedate)!=6 and
  t1.currency='EURUSD'
;